import{Q as C}from"./QCardSection-CiG6isgs.js";import{Q as w}from"./QInput-C9VUkdKg.js";import{Q as I,a as m}from"./QItem-CVdRD1o1.js";import{Q as y,R as j}from"./QBtn-BmTDBXaF.js";import{Q as P}from"./QSpace-BjsO4rCe.js";import{Q as F}from"./QChip-BGJbybnP.js";import{Q as Y}from"./QCheckbox-Clkdzp6y.js";import{Q as x}from"./QItemLabel-BEwWYBE7.js";import{Q as z}from"./QList-Bha-pkFx.js";import{Q as R}from"./QCard-r55_QlSX.js";import{Q as A}from"./QDialog-CVyoV1M0.js";import{Q as Z}from"./QPage-CvTATe-M.js";import{_ as D}from"./InnerLoading-Ba0I8PfN.js";import{u as H}from"./company-BhloN_DI.js";import{_ as h}from"./ViewQRCodePopupCard-DRGRiVUl.js";import{Q as E}from"./use-router-link-Dr-Zi9tW.js";import{Q as M}from"./QBar-ByfD1wO8.js";import{C as G}from"./ClosePopup-CcfEm1UV.js";import{l as T}from"./lodash-BMWjruN6.js";import{u as J}from"./user-_mu4dbbL.js";import{h as Q,a as V,o as c,w as l,e,i as B,j as K,c as N,f,g as O,F as W,r as X,t as S,k as q,b as ee,u as le}from"./index-D3MJetay.js";import{u as ae}from"./routes-BuNAvqSB.js";import{u as oe}from"./title-BishfVJW.js";import"./render-DOsC2Df9.js";import"./vm-D0m787GO.js";import"./use-id-3XFJ6Wvj.js";import"./use-dark-zETD_P0k.js";import"./dom-t3s1oZ0g.js";import"./use-checkbox-XbZu4Brg.js";import"./use-prevent-scroll-a4Ly7Ch6.js";import"./scroll-Donk8pry.js";import"./use-timeout-BZCs8B8e.js";import"./use-model-toggle-CLRdDvpD.js";import"./axios-DBCVI-8M.js";import"./use-quasar-Cl2twILc.js";import"./_commonjsHelpers-_d1bhYXs.js";const ne={__name:"IndividualUserUpdate",props:["user"],emits:["close"],setup(k,{emit:b}){const U=J(),n=k,_=b,a=Q({name:"",email:"",password:""}),d=Q(!1);function p(){if(d.value=!0,a.value.name.trim()===""&&a.value.email.trim()===""&&a.value.password.trim()==="")return d.value=!1;a.value.password.trim()!==""&&U.updateUserPassword(n.user.id,a.value.password).then(v),(a.value.name||a.value.email)&&U.updateUserBasic(n.user.id,{name:a.value.name||n.user.name,email:a.value.email||n.user.email}).then(v)}function v(){["name","email","password"].map(g=>a.value[g]=""),d.value=!1,_("close")}return(g,t)=>(c(),V(R,null,{default:l(()=>[e(M,null,{default:l(()=>[e(E,{name:"lens_blur"}),e(P),B(e(y,{icon:"close",flat:"",color:"primary",dense:"",round:""},null,512),[[G]])]),_:1}),e(C,{class:"q-gutter-y-xs"},{default:l(()=>[e(w,{"model-value":a.value.name||n.user.name,label:"Name",outlined:"","onUpdate:modelValue":t[0]||(t[0]=i=>a.value.name=i)},null,8,["model-value"]),e(w,{"model-value":a.value.email||n.user.email,label:"Email",outlined:"","onUpdate:modelValue":t[1]||(t[1]=i=>a.value.email=i)},null,8,["model-value"]),e(w,{"model-value":a.value.password,label:"Password",outlined:"",hint:"Leave password empty if no changes","onUpdate:modelValue":t[2]||(t[2]=i=>a.value.password=i)},null,8,["model-value"]),e(y,{color:"primary",padding:"sm lg",label:"Update User",onClick:p})]),_:1}),e(D,{loading:d.value},null,8,["loading"])]),_:1}))}},ue={class:"row q-col-gutter-x-xs"},de={class:"col"},te={class:"col"},ie={__name:"IndividualUsersManage",props:["company_id","individual_id"],setup(k){const b=H(),U=J(),n=k,_=Q(!1),a=K({name:"",email:"",password:""}),d=Q(null),p=N(()=>b.Individual(n.company_id,n.individual_id)),v=N(()=>p.value?T.map(p.value.users,i=>U.UsersById[i]).filter(i=>i):[]);function g(){if(!a.name||!a.email||!a.password)return null;_.value=!0,b.createAndAddIndividualUser(n.company_id,n.individual_id,a).then(t)}function t(){T.map(a,(i,o)=>a[o]=""),_.value=!1}return(i,o)=>(c(),V(R,null,{default:l(()=>[e(M,null,{default:l(()=>[e(E,{name:"lens_blur"}),e(P),B(e(y,{icon:"close",flat:"",color:"primary",dense:"",round:""},null,512),[[G]])]),_:1}),e(C,{class:"text-bold bg-grey-2"},{default:l(()=>[...o[4]||(o[4]=[f("User Logins",-1)])]),_:1}),e(z,null,{default:l(()=>[v.value.length?(c(!0),O(W,{key:0},X(v.value,s=>B((c(),V(I,{clickable:"",onClick:$=>d.value=s},{default:l(()=>[e(m,{side:""},{default:l(()=>[e(E,{name:"lens_blur",color:"green"})]),_:1}),e(m,null,{default:l(()=>[e(x,null,{default:l(()=>[f(S(s.name),1)]),_:2},1024),e(x,{caption:""},{default:l(()=>[f(S(s.email),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[j]])),256)):(c(),V(x,{key:1,header:""},{default:l(()=>[...o[5]||(o[5]=[f("No users",-1)])]),_:1}))]),_:1}),e(C,{class:"text-bold bg-grey-2"},{default:l(()=>[...o[6]||(o[6]=[f("Add User",-1)])]),_:1}),e(C,{class:"q-gutter-y-xs"},{default:l(()=>[e(w,{modelValue:a.name,"onUpdate:modelValue":o[0]||(o[0]=s=>a.name=s),label:"Name",outlined:""},null,8,["modelValue"]),q("div",ue,[q("div",de,[e(w,{modelValue:a.email,"onUpdate:modelValue":o[1]||(o[1]=s=>a.email=s),label:"Email",outlined:""},null,8,["modelValue"])]),q("div",te,[e(w,{modelValue:a.password,"onUpdate:modelValue":o[2]||(o[2]=s=>a.password=s),label:"Password",outlined:""},null,8,["modelValue"])])]),e(y,{color:"primary",padding:"sm lg",label:"Add User",onClick:g})]),_:1}),e(A,{persistent:"","full-width":"","model-value":d.value!==null},{default:l(()=>[e(ne,{user:d.value,onClose:o[3]||(o[3]=s=>d.value=null)},null,8,["user"])]),_:1},8,["model-value"]),e(D,{loading:_.value},null,8,["loading"])]),_:1}))}},Ge={__name:"Individuals",props:["company_id"],setup(k){const b=H(),U=ae(),n=k,_=N(()=>b.CompaniesById[n.company_id]),a=N(()=>_.value?.individuals),d=K({name:""}),p=Q([]),v=Q(!1),g=Q(!1),t=Q(null);function i(){v.value=!0,b.addIndividual(n.company_id,d.name).then(o)}function o(){d.name="",v.value=!1}function s({id:$}){t.value=$}return oe(_),($,u)=>(c(),V(Z,{padding:""},{default:l(()=>[e(R,null,{default:l(()=>[e(C,{class:"text-bold bg-grey-2"},{default:l(()=>[...u[5]||(u[5]=[f("Add New Individual",-1)])]),_:1}),e(I,null,{default:l(()=>[e(m,null,{default:l(()=>[e(w,{modelValue:d.name,"onUpdate:modelValue":u[0]||(u[0]=r=>d.name=r),outlined:"",label:"Individual Name"},null,8,["modelValue"])]),_:1}),e(m,{side:""},{default:l(()=>[e(y,{icon:"forward",flat:"",dense:"",color:"primary",onClick:i})]),_:1})]),_:1}),e(C,{class:"text-bold bg-grey-2 flex items-center"},{default:l(()=>[u[6]||(u[6]=f("Existing Individuals",-1)),e(P),e(F,{label:a.value?.length||0,class:"q-ma-none"},null,8,["label"])]),_:1}),e(z,{separator:""},{default:l(()=>[(c(!0),O(W,null,X(a.value,r=>(c(),V(I,null,{default:l(()=>[e(m,{side:""},{default:l(()=>[e(Y,{modelValue:p.value,"onUpdate:modelValue":u[1]||(u[1]=L=>p.value=L),val:r.id},null,8,["modelValue","val"])]),_:2},1024),e(m,null,{default:l(()=>[e(x,{caption:""},{default:l(()=>[f(S(r.code),1)]),_:2},1024),e(x,null,{default:l(()=>[f(S(r.name),1)]),_:2},1024)]),_:2},1024),e(m,{side:""},{default:l(()=>[e(y,{dense:"",icon:"login",flat:"",color:"primary",onClick:L=>s(r)},null,8,["onClick"])]),_:2},1024),e(m,{side:""},{default:l(()=>[e(y,{dense:"",icon:"forward",flat:"",color:"primary",onClick:L=>le(U).push("company_individual",r)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256)),p.value.length?B((c(),V(I,{key:0,clickable:"",onClick:u[2]||(u[2]=r=>g.value=!0)},{default:l(()=>[e(m,{side:""},{default:l(()=>[e(F,{label:p.value.length},null,8,["label"])]),_:1}),e(m,null,{default:l(()=>[...u[7]||(u[7]=[f("View QR Code",-1)])]),_:1}),e(m,{side:""},{default:l(()=>[e(y,{dense:"",icon:"qr_code",flat:"",color:"primary"})]),_:1})]),_:1})),[[j]]):ee("",!0)]),_:1})]),_:1}),e(A,{persistent:"",maximized:!0,modelValue:g.value,"onUpdate:modelValue":u[3]||(u[3]=r=>g.value=r)},{default:l(()=>[e(h,{individual_ids:p.value,company_id:n.company_id},null,8,["individual_ids","company_id"])]),_:1},8,["modelValue"]),e(A,{persistent:"","model-value":t.value!==null,onBeforeHide:u[4]||(u[4]=r=>t.value=null)},{default:l(()=>[e(ie,{class:"full-width",company_id:n.company_id,individual_id:t.value},null,8,["company_id","individual_id"])]),_:1},8,["model-value"]),e(D,{loading:v.value},null,8,["loading"])]),_:1}))}};export{Ge as default};
