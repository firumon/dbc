import{Q as S}from"./QSpace-Y9BK-8G3.js";import{Q as p}from"./QBtn-CmpX_coh.js";import{Q as k}from"./QCardSection-Jbcbm-vP.js";import{Q as $}from"./QCheckbox-Bz9seUNV.js";import{Q as j,a as b}from"./QItem-Dgu9JK4v.js";import{Q as I}from"./QItemLabel-Bc19V8a5.js";import{Q as q}from"./QList-DmXAj4qO.js";import{Q as A}from"./QCardActions-Cei77pT8.js";import{Q as B}from"./QCard-Dz9uU80K.js";import{Q as F}from"./use-router-link-CSWtRJzU.js";import{Q as T}from"./QBar-DtggA4KL.js";import{Q as C}from"./QInput-xwkH9gNC.js";import{Q as O}from"./QDialog-DIDeD7D9.js";import{Q as z}from"./QPage-CMxJKmsA.js";import{C as G}from"./ClosePopup-C2UBjTUF.js";import{_ as H}from"./InnerLoading-CpwP3uL1.js";import{_ as J}from"./ChooseCompanySelect-C6s-Rz62.js";import{u as K}from"./company-C-bWVBI7.js";import{l as f}from"./lodash-BMWjruN6.js";import{u as R}from"./user-BN_EHo7G.js";import{u as W}from"./title-DVMFqw8Q.js";import{h as c,j as X,c as v,p as Y,a as U,o as Q,w as o,b as Z,e,f as m,g as h,r as ee,F as ae,i as le,t as w}from"./index-CVIMlvYm.js";import"./vm-C9CMmNuj.js";import"./dom-D7QtCoj4.js";import"./render-6HoAj0_g.js";import"./use-checkbox-iFpzt5Mb.js";import"./use-dark-DkcyDAJO.js";import"./use-id-CgI_dfuk.js";import"./use-prevent-scroll-CA8N-g0I.js";import"./scroll-Bz2OQy8r.js";import"./use-timeout-CIWZKlVR.js";import"./use-model-toggle-eX9UmeE1.js";import"./QSelect-BP46biaE.js";import"./QChip-D8QrZMEs.js";import"./format-CSSDOkxg.js";import"./axios-Din57D94.js";import"./_commonjsHelpers-_d1bhYXs.js";const Fe={__name:"Users",props:["company_id"],setup(N){const s=K(),P=R(),g=N,y=c(g.company_id),u=c(!1),i=c(!1),t=X({name:"",email:"",password:""}),d=c([]),n=v(()=>y.value||g.company_id),V=v(()=>n.value?s.CompaniesById[n.value]:null),_=v(()=>f.filter(P.Users,["role","Manager"])),D=v(function(){const r={};return _.value&&f.map(s.Companies,a=>f.map(a.users,l=>{r.hasOwnProperty(l)||(r[l]=[]),r[l].includes(a.name)||r[l].push(a.name)})),r});Y(V,function(r){d.value=r?s.Users(r.id):[]},{immediate:!0,deep:!0});function E(){u.value=!0,s.syncCompanyUsers(n.value,d.value).then(x)}function L(){if(!t.name||!t.email||!t.password)return null;u.value=!0,s.createAndAddUser(n.value,t).then(x)}function x(){f.map(t,(r,a)=>t[a]=""),i.value=!1,u.value=!1}return W(V),(r,a)=>(Q(),U(z,{padding:"",class:"q-gutter-y-xs"},{default:o(()=>[g.company_id?Z("",!0):(Q(),U(J,{key:0,label:"Select Company",modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=l=>y.value=l)},null,8,["modelValue"])),e(B,null,{default:o(()=>[e(k,{class:"text-bold bg-grey-2 flex items-center"},{default:o(()=>[a[7]||(a[7]=m("Managers ",-1)),e(S),a[8]||(a[8]=m()),e(p,{round:"",color:"secondary",dense:"",icon:"add",onClick:a[1]||(a[1]=l=>i.value=!0),disable:!n.value},null,8,["disable"])]),_:1}),e(q,null,{default:o(()=>[(Q(!0),h(ae,null,ee(_.value,l=>(Q(),U(j,null,{default:o(()=>[e(b,{side:""},{default:o(()=>[e($,{val:l.id,modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=M=>d.value=M)},null,8,["val","modelValue"])]),_:2},1024),e(b,null,{default:o(()=>[e(I,null,{default:o(()=>[m(w(l.name),1)]),_:2},1024),e(I,{caption:""},{default:o(()=>[m(w(l.email),1)]),_:2},1024)]),_:2},1024),e(b,{side:""},{default:o(()=>[m(w((D.value[l.id]||[]).join(", ")),1)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(A,{class:"bg-grey-2",align:"right"},{default:o(()=>[e(p,{color:"primary",label:"Sync Managers",onClick:E,disable:!V.value},null,8,["disable"])]),_:1})]),_:1}),e(O,{modelValue:i.value,"onUpdate:modelValue":a[6]||(a[6]=l=>i.value=l),persistent:""},{default:o(()=>[e(B,{class:"full-width"},{default:o(()=>[e(T,null,{default:o(()=>[e(F,{name:"groups_3"}),e(S),le(e(p,{dense:"",flat:"",icon:"close"},null,512),[[G]])]),_:1}),e(k,{class:"q-gutter-y-xs"},{default:o(()=>[e(C,{modelValue:t.name,"onUpdate:modelValue":a[3]||(a[3]=l=>t.name=l),label:"Name",outlined:""},null,8,["modelValue"]),e(C,{modelValue:t.email,"onUpdate:modelValue":a[4]||(a[4]=l=>t.email=l),label:"Email",outlined:""},null,8,["modelValue"]),e(C,{modelValue:t.password,"onUpdate:modelValue":a[5]||(a[5]=l=>t.password=l),label:"Password",outlined:""},null,8,["modelValue"])]),_:1}),e(A,{align:"right",class:"bg-grey-2"},{default:o(()=>[e(p,{color:"primary",label:"Add User",onClick:L})]),_:1}),e(H,{loading:u.value},null,8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Fe as default};
