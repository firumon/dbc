import{Q as y}from"./QCardSection-Jbcbm-vP.js";import{Q as k}from"./QItemLabel-Bc19V8a5.js";import{Q as x,a as c}from"./QItem-Dgu9JK4v.js";import{Q as I}from"./QBtn-CmpX_coh.js";import{Q as T}from"./QSeparator-B3hoT1kt.js";import{Q as h}from"./QList-DmXAj4qO.js";import{Q as A}from"./QChip-D8QrZMEs.js";import{Q as D}from"./QCard-Dz9uU80K.js";import{Q as O}from"./QPage-CMxJKmsA.js";import{u as W}from"./user-BN_EHo7G.js";import{u as j}from"./title-DVMFqw8Q.js";import{l as S}from"./lodash-BMWjruN6.js";import{u as q}from"./company-C-bWVBI7.js";import{_ as z}from"./InnerLoading-CpwP3uL1.js";import{h as C,c as Q,p as G,a as s,o,w as l,e as a,b as H,f as i,g as v,r as b,F as _,t as g}from"./index-CVIMlvYm.js";import"./render-6HoAj0_g.js";import"./use-dark-DkcyDAJO.js";import"./use-router-link-CSWtRJzU.js";import"./vm-C9CMmNuj.js";import"./dom-D7QtCoj4.js";import"./axios-Din57D94.js";import"./_commonjsHelpers-_d1bhYXs.js";const ye={__name:"LoginManage",props:["user_id"],setup(w){const L=W(),d=q(),E=w,m=C(!1),r=C({}),p=C(null),B=C({}),f=Q(()=>L.UsersById[E.user_id]);j(f);const R=Q(()=>d.Companies),V=Q(()=>f.value?S.filter(S.flatMap(d.Companies,"individuals"),({users:n})=>n.includes(f.value.id)):[]),N=Q(()=>p.value?d.CompaniesById[p.value].individuals:[]);function F(n){return d.CompaniesById[n].name}G(V,function(n){r.value={},S.map(n,function({company_id:t,id:e,name:u}){r.value.hasOwnProperty(t)||(r.value[t]={company_name:F(t),individuals:[]}),r.value[t].individuals.push(e),B.value[e]=u})},{immediate:!0});function U(n,t){m.value=!0,d.removeIndividualUser(n,t,f.value.id).then(()=>m.value=!1)}function M(n,t){m.value=!0,d.addIndividualUser(n,t,f.value.id).then(()=>m.value=!1)}return(n,t)=>(o(),s(O,{padding:""},{default:l(()=>[a(D,null,{default:l(()=>[a(y,{class:"bg-grey-2 text-bold"},{default:l(()=>[...t[1]||(t[1]=[i("Existing Individuals",-1)])]),_:1}),a(h,null,{default:l(()=>[(o(!0),v(_,null,b(r.value,(e,u)=>(o(),v(_,null,[a(x,null,{default:l(()=>[a(c,null,{default:l(()=>[a(k,{class:"text-bold"},{default:l(()=>[i(g(e.company_name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),(o(!0),v(_,null,b(e.individuals,($,P)=>(o(),s(x,null,{default:l(()=>[a(c,null,{default:l(()=>[i(g(P+1)+". "+g(B.value[$]),1)]),_:2},1024),a(c,{side:""},{default:l(()=>[a(I,{dense:"",padding:"xs md",label:"Remove",outline:"",rounded:"",color:"primary",onClick:J=>U(u,$)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256)),a(T)],64))),256))]),_:1}),a(y,{class:"bg-grey-2 text-bold"},{default:l(()=>[...t[2]||(t[2]=[i("Companies",-1)])]),_:1}),a(y,null,{default:l(()=>[(o(!0),v(_,null,b(R.value,e=>(o(),s(A,{label:e.name,onClick:u=>p.value=e.id,onRemove:t[0]||(t[0]=u=>p.value=null),clickable:"",outline:p.value!==e.id,color:"secondary","text-color":"white"},null,8,["label","onClick","outline"]))),256))]),_:1}),a(y,{class:"bg-grey-2 text-bold"},{default:l(()=>[...t[3]||(t[3]=[i("Company Individuals",-1)])]),_:1}),N.value.length?(o(),s(h,{key:0,separator:""},{default:l(()=>[(o(!0),v(_,null,b(N.value,e=>(o(),s(x,null,{default:l(()=>[a(c,null,{default:l(()=>[a(k,{caption:""},{default:l(()=>[i(g(e.code),1)]),_:2},1024),a(k,null,{default:l(()=>[i(g(e.name),1)]),_:2},1024)]),_:2},1024),a(c,{side:""},{default:l(()=>[r.value[e.company_id]&&r.value[e.company_id].individuals.includes(e.id)?(o(),s(I,{key:0,dense:"",padding:"xs md",label:"Remove",outline:"",rounded:"",color:"primary",onClick:u=>U(e.company_id,e.id)},null,8,["onClick"])):(o(),s(I,{key:1,dense:"",padding:"xs md",label:"Add",outline:"",rounded:"",color:"primary",onClick:u=>M(e.company_id,e.id)},null,8,["onClick"]))]),_:2},1024)]),_:2},1024))),256))]),_:1})):H("",!0)]),_:1}),a(z,{loading:m.value},null,8,["loading"])]),_:1}))}};export{ye as default};
