import{Q as S}from"./QSpace-CYv9toBz.js";import{Q as p}from"./QBtn-8kexOv-L.js";import{Q as k}from"./QCardSection-B8zqNFw5.js";import{Q as $}from"./QCheckbox-DRk718Mj.js";import{Q as j,a as b}from"./QItem-B3a1-EVM.js";import{Q as I}from"./QItemLabel-y0CeKWRr.js";import{Q as q}from"./QList-BLNtoxNV.js";import{Q as A}from"./QCardActions-BkXs8E73.js";import{Q as B}from"./QCard-zMgqcLyM.js";import{Q as F}from"./use-router-link-C1KlW-z0.js";import{Q as T}from"./QBar-4-_vD8CY.js";import{Q as C}from"./QInput-DwGHxsu1.js";import{Q as O}from"./QDialog-CnP1ldga.js";import{Q as z}from"./QPage-RsarDNA8.js";import{C as G}from"./ClosePopup-aAkirXHI.js";import{_ as H}from"./InnerLoading-BSoZfbcz.js";import{_ as J}from"./ChooseCompanySelect-DbSqL8nV.js";import{u as K}from"./company-B_tY9lVt.js";import{l as f}from"./lodash-BMWjruN6.js";import{u as R}from"./user-CzO-FWtq.js";import{u as W}from"./title-B4t3WEGW.js";import{h as c,j as X,c as v,p as Y,a as U,o as Q,w as o,b as Z,e,f as m,g as h,r as ee,F as ae,i as le,t as w}from"./index-DPf0em9p.js";import"./vm-B-IvL0So.js";import"./dom-DYRJl-LZ.js";import"./render-BBT-_xwK.js";import"./use-checkbox-KnnUCe7V.js";import"./use-dark-DWgxBQGk.js";import"./use-id-eV3rINdq.js";import"./use-prevent-scroll-8O9FDE32.js";import"./scroll-UIkbkDpm.js";import"./use-timeout-BsMn8phE.js";import"./use-model-toggle-DXD9td5r.js";import"./QSelect-B6DyI-vr.js";import"./QChip-Bshvjc4N.js";import"./format-D5dN_LUK.js";import"./axios-BJmCVD_q.js";import"./_commonjsHelpers-_d1bhYXs.js";const Fe={__name:"Users",props:["company_id"],setup(N){const s=K(),P=R(),g=N,y=c(g.company_id),u=c(!1),i=c(!1),t=X({name:"",email:"",password:""}),d=c([]),n=v(()=>y.value||g.company_id),V=v(()=>n.value?s.CompaniesById[n.value]:null),_=v(()=>f.filter(P.Users,["role","Manager"])),D=v(function(){const r={};return _.value&&f.map(s.Companies,a=>f.map(a.users,l=>{r.hasOwnProperty(l)||(r[l]=[]),r[l].includes(a.name)||r[l].push(a.name)})),r});Y(V,function(r){d.value=r?s.Users(r.id):[]},{immediate:!0,deep:!0});function E(){u.value=!0,s.syncCompanyUsers(n.value,d.value).then(x)}function L(){if(!t.name||!t.email||!t.password)return null;u.value=!0,s.createAndAddUser(n.value,t).then(x)}function x(){f.map(t,(r,a)=>t[a]=""),i.value=!1,u.value=!1}return W(V),(r,a)=>(Q(),U(z,{padding:"",class:"q-gutter-y-xs"},{default:o(()=>[g.company_id?Z("",!0):(Q(),U(J,{key:0,label:"Select Company",modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=l=>y.value=l)},null,8,["modelValue"])),e(B,null,{default:o(()=>[e(k,{class:"text-bold bg-grey-2 flex items-center"},{default:o(()=>[a[7]||(a[7]=m("Managers ",-1)),e(S),a[8]||(a[8]=m()),e(p,{round:"",color:"secondary",dense:"",icon:"add",onClick:a[1]||(a[1]=l=>i.value=!0),disable:!n.value},null,8,["disable"])]),_:1}),e(q,null,{default:o(()=>[(Q(!0),h(ae,null,ee(_.value,l=>(Q(),U(j,null,{default:o(()=>[e(b,{side:""},{default:o(()=>[e($,{val:l.id,modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=M=>d.value=M)},null,8,["val","modelValue"])]),_:2},1024),e(b,null,{default:o(()=>[e(I,null,{default:o(()=>[m(w(l.name),1)]),_:2},1024),e(I,{caption:""},{default:o(()=>[m(w(l.email),1)]),_:2},1024)]),_:2},1024),e(b,{side:""},{default:o(()=>[m(w((D.value[l.id]||[]).join(", ")),1)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(A,{class:"bg-grey-2",align:"right"},{default:o(()=>[e(p,{color:"primary",label:"Sync Managers",onClick:E,disable:!V.value},null,8,["disable"])]),_:1})]),_:1}),e(O,{modelValue:i.value,"onUpdate:modelValue":a[6]||(a[6]=l=>i.value=l),persistent:""},{default:o(()=>[e(B,{class:"full-width"},{default:o(()=>[e(T,null,{default:o(()=>[e(F,{name:"groups_3"}),e(S),le(e(p,{dense:"",flat:"",icon:"close"},null,512),[[G]])]),_:1}),e(k,{class:"q-gutter-y-xs"},{default:o(()=>[e(C,{modelValue:t.name,"onUpdate:modelValue":a[3]||(a[3]=l=>t.name=l),label:"Name",outlined:""},null,8,["modelValue"]),e(C,{modelValue:t.email,"onUpdate:modelValue":a[4]||(a[4]=l=>t.email=l),label:"Email",outlined:""},null,8,["modelValue"]),e(C,{modelValue:t.password,"onUpdate:modelValue":a[5]||(a[5]=l=>t.password=l),label:"Password",outlined:""},null,8,["modelValue"])]),_:1}),e(A,{align:"right",class:"bg-grey-2"},{default:o(()=>[e(p,{color:"primary",label:"Add User",onClick:L})]),_:1}),e(H,{loading:u.value},null,8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Fe as default};
